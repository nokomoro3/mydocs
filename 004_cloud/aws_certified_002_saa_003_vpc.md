# VPC

## IPアドレス

- ICANNという非営利団体が管理
- IPアドレスは重複が許されない
- IPアドレスは32bit。10進法表記では、0.0.0.0～255.255.255.255の範囲。
- IPアドレスはNIC(Network Interface Card)に割り当てられる。

## グローバルIPアドレスの枯渇

- IPv4は枯渇しかけている。
- IPv6が使われているが、主要なのはまだIPv4で、IPv6は補助的。
- 移行が順次行われいている。

## globalとprivate

- global
  - Internetでのやり取りに使用される。
  - ICANNが管理する。
  - 世界中で一意である必要があり、重複不可。

- private
  - オフィスや家庭内など限定的なエリアだけで利用されるアドレス。
  - エリア内では重複不可だが、globalでは重複可。
  - 設定できる範囲は以下のように決まっている。
    - 10.0.0.0～10.255.255.255
    - 172.16.0.0～172.31.255.255
    - 192.168.0.0～192.168.255.255

## サブネットマスクとサブネット

- IPアドレスの利用可能な範囲を決めることが可能。
- 以下の`/16`の部分がサブネットマスクである。
  - 左側から16bitまでが固定値という意味である。
```
10.0.1.0/16
```

- CIDR(Classless Inter-Domain Routing)とは
  - 同じサブネットとして扱うIPアドレスの個数を調整できるIPアドレスの設定方法
  - 以下であれば、10.0.XXX.XXXが同じサブネット内のIPアドレスとみなされる。
  - この場合、同じネットワーク内には、65536個存在しうる。
```
10.0.1.0/16
```

- 固定されている部分をネットワーク部、設定可能な部分をホスト部という。

- `/16`と`/24`がよく使われる。
  - 単に使う場合は`/16`、その中でサブネットを分ける場合は`/24`を使うケースが多い。

- サブネットにするメリット
  - サブネットに分割することによって、分割することにより宛先を発見しやすくなる。
  - サブネット毎にグループを分ける。
    - publicはインターネット接続あり、privateはセキュアなネットワークにする、など。

- サブネットマスクは、サブネットにしか使わないわけではない。
  - privateネットワーク全体にもサブネットマスクがある。
  - そしてもちろんその中のサブネットにも、サブネットマスクを設定できる。

## VPCとは

- Virtual Private Cloud
- 仮想ネットワークを作るサービス
- 最初のAWSアカウントを作成と同時に、AWSクラウドのネットワークから、ユーザー専用の領域を切り出してくれるのもVPC。
- これがデフォルトのVPCのことである。
- これは、各リージョンで実行される。

- 以下が可能
  - 任意のIPアドレス範囲を選択して仮想ネットワークを構築
  - サブネットの作成、ルートテーブルやネットワークゲートウェイの設定など仮想ネットワークを完全に制御可能。
  - 必要に応じてクラウド内外のネットワーク同士の接続が可能。
  - その中でオンプレと接続する際、様々な接続オプションが利用可能
    - インターネット経由
    - VPN/専用線(Direct Connect)

- VPCとAZ
  - 通常一つのAZ内で構築される。
  - 同一リージョン内では、複数のAZにまたがって構築することも可能。
    - 構築後、サブネットを別のAZに設定することで実現できる。

- VPCとサブネット
  - VPCは構築と同時に一つのサブネットをもつ。
